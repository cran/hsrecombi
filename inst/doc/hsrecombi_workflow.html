<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="D. Wittenburg" />


<title>Description of the workflow for constructing a genetic map using hsrecombi</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Description of the workflow for constructing a genetic map using <em>hsrecombi</em></h1>
<h4 class="author">D. Wittenburg</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><em>hsrecombi</em> can approximate the genetic-map positions of genetic markers from SNP genotypes in half-sib families. It is referred to <a href="https://doi.org/10.3389/fgene.2018.00186">Hampel et al.Â (2018, Fron Gen)</a> and <a href="https://doi.org/10.1186/s12711-020-00593-z">Qanbari &amp; Wittenburg (2020, Genet Sel Evol)</a> for more information on the methodology. The workflow relies on paternal half-sib families but it can be adapted to maternal half-sib families with minor modifications.</p>
<p>In <strong>Part I</strong>, genotypic data from progeny and their common parents are simulated with the R package <a href="https://CRAN.R-project.org/package=AlphaSimR"><em>AlphaSimR</em></a> and reshaped into the PLINK format. If genotypic data are already available in the required PLINK format, the workflow starts directly at <strong>Part II</strong>.</p>
<p>Required input files:</p>
<ul>
<li>map files for each chromosome <code>map_chr&lt;chr&gt;.map</code></li>
<li>data files for each chromosome <code>hsphase_input_chr&lt;chr&gt;.raw</code></li>
</ul>
<p><strong>Note:</strong> A pipeline is available at <a href="https://github.com/wittenburg/hsrecombi">github</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(hsrecombi)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(AlphaSimR)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#&gt; Loading required package: R6</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(doParallel)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; Loading required package: foreach</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; Loading required package: iterators</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; Loading required package: parallel</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">library</span>(rlist)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">Sys.time</span>()</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; [1] &quot;2021-03-23 08:57:30 CET&quot;</span></span></code></pre></div>
<div id="global-variables" class="section level3">
<h3>Global variables</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># number of chromosomes</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>nchr &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Number of simulated SNPs (e.g., p = 1500 resembles an average bovine chromosome)</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>p &lt;-<span class="st"> </span><span class="dv">150</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># Number of simulated progeny in each half-sib family</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># Directory for (simulated) data</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>path.dat &lt;-<span class="st"> &quot;data&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="kw">dir.create</span>(path.dat, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># Directory for output</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>path.res &lt;-<span class="st"> &quot;results&quot;</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="kw">dir.create</span>(path.res, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># Number of computing clusters allocated</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>nclust &lt;-<span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<p>For instance, executing the following workflow with <span class="math inline">\(p=1500\)</span> and <span class="math inline">\(n\geq 1000\)</span> requires about 120 Mb storage space and 10 min computing time (2.6 GHz processor). With <span class="math inline">\(p=150\)</span>, it takes about 7 Mb and 20 sec.</p>
</div>
</div>
<div id="part-i-data-simulation-and-preparation" class="section level2">
<h2>Part I: Data simulation and preparation</h2>
<div id="simulation-of-genetic-data-with-r-package-alphasimr" class="section level3">
<h3>1: Simulation of genetic data with R package <em>AlphaSimR</em></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>founderPop &lt;-<span class="st"> </span><span class="kw">runMacs2</span>(<span class="dt">nInd =</span> <span class="dv">1000</span>, <span class="dt">nChr =</span> nchr, <span class="dt">segSites =</span> p)</span>
<span id="cb3-2"><a href="#cb3-2"></a>SP &lt;-<span class="st"> </span>SimParam<span class="op">$</span><span class="kw">new</span>(founderPop)</span>
<span id="cb3-3"><a href="#cb3-3"></a>SP<span class="op">$</span><span class="kw">setSexes</span>(<span class="st">&quot;yes_sys&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># Enable tracing location of recombination events</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>SP<span class="op">$</span><span class="kw">setTrackRec</span>(<span class="ot">TRUE</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>pop &lt;-<span class="st"> </span><span class="kw">newPop</span>(founderPop)</span>
<span id="cb3-8"><a href="#cb3-8"></a>N &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>ntotal &lt;-<span class="st"> </span>N <span class="op">*</span><span class="st"> </span>n</span>
<span id="cb3-10"><a href="#cb3-10"></a>my_pop &lt;-<span class="st"> </span><span class="kw">selectCross</span>(<span class="dt">pop =</span> pop, <span class="dt">nFemale =</span> <span class="dv">500</span>, <span class="dt">nMale =</span> N, <span class="dt">use =</span> <span class="st">&quot;rand&quot;</span>, <span class="dt">nCrosses =</span> ntotal)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>probRec &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="cf">for</span> (chr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nchr) {</span>
<span id="cb3-14"><a href="#cb3-14"></a>    co.pat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> p, <span class="dt">nrow =</span> ntotal)</span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>ntotal) {</span>
<span id="cb3-16"><a href="#cb3-16"></a>        <span class="cf">if</span> (<span class="kw">nrow</span>(SP<span class="op">$</span>recHist[[<span class="dv">1000</span> <span class="op">+</span><span class="st"> </span>i]][[chr]][[<span class="dv">2</span>]]) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb3-17"><a href="#cb3-17"></a>            <span class="co"># 1. line contains 1 1 by default</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>            loci &lt;-<span class="st"> </span>SP<span class="op">$</span>recHist[[<span class="dv">1000</span> <span class="op">+</span><span class="st"> </span>i]][[chr]][[<span class="dv">2</span>]][<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb3-19"><a href="#cb3-19"></a>            co.pat[i, loci] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>        }</span>
<span id="cb3-21"><a href="#cb3-21"></a>    }</span>
<span id="cb3-22"><a href="#cb3-22"></a>    probRec[[chr]] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(co.pat)</span>
<span id="cb3-23"><a href="#cb3-23"></a>}</span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">c</span>(<span class="st">&quot;SP&quot;</span>, <span class="st">&quot;founderPop&quot;</span>, <span class="st">&quot;pop&quot;</span>, <span class="st">&quot;my_pop&quot;</span>, <span class="st">&quot;ntotal&quot;</span>, <span class="st">&quot;probRec&quot;</span>), <span class="dt">file =</span> <span class="st">&quot;data/pop.RData&quot;</span>)</span></code></pre></div>
<p>Two chromosomes, each with <span class="math inline">\(p\)</span> SNPs and 1 Morgan length, are simulated. The founder population consists of 1,000 animals with equal gender distribution. The follow-up generation consists of <span class="math inline">\(N\)</span> paternal-half sib families with equal number of progeny <span class="math inline">\(n\)</span>. The study design with the equal number of progeny per family was preferred here for simplicity but this is not required in the subsequent steps.</p>
</div>
<div id="selection-of-sire-haplotypes-and-progeny-genotypes" class="section level3">
<h3>2: Selection of sire haplotypes and progeny genotypes</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>PAT &lt;-<span class="st"> </span>my_pop<span class="op">@</span>father</span>
<span id="cb4-2"><a href="#cb4-2"></a>rown &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="kw">unique</span>(PAT), <span class="dt">each =</span> <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>H.pat &lt;-<span class="st"> </span><span class="kw">pullSegSiteHaplo</span>(pop)[rown, ]</span>
<span id="cb4-4"><a href="#cb4-4"></a>X &lt;-<span class="st"> </span><span class="kw">pullSegSiteGeno</span>(my_pop)</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># Physical position of markers in Mbp</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>map.snp &lt;-<span class="st"> </span><span class="kw">lapply</span>(founderPop<span class="op">@</span>genMap, <span class="cf">function</span>(z) z <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span></code></pre></div>
<p>Note that <code>founderPop@genMap</code> includes genetic positions in Morgan units but physical positions are required in the next steps.</p>
</div>
<div id="reshaping-data-into-plink-format" class="section level3">
<h3>3: Reshaping data into PLINK format</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>map &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Chr =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(map.snp), <span class="kw">unlist</span>(<span class="kw">lapply</span>(map.snp, length))), <span class="dt">Name =</span> <span class="kw">paste0</span>(<span class="st">&quot;SNP&quot;</span>, </span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unlist</span>(map.snp))), <span class="dt">locus_Mb =</span> <span class="kw">unlist</span>(map.snp), <span class="dt">locus_bp =</span> <span class="kw">unlist</span>(map.snp) <span class="op">*</span><span class="st"> </span><span class="fl">1e+06</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span>map<span class="op">$</span>Name</span>
<span id="cb5-5"><a href="#cb5-5"></a>FID &lt;-<span class="st"> &quot;FAM001&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>IID &lt;-<span class="st"> </span>my_pop<span class="op">@</span>id</span>
<span id="cb5-7"><a href="#cb5-7"></a>MAT &lt;-<span class="st"> </span>my_pop<span class="op">@</span>mother</span>
<span id="cb5-8"><a href="#cb5-8"></a>SEX &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>PHENOTYPE &lt;-<span class="st"> </span><span class="dv">-9</span></span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="cf">for</span> (chr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nchr) {</span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="kw">write.table</span>(map[map<span class="op">$</span>Chr <span class="op">==</span><span class="st"> </span>chr, ], <span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;map_chr&quot;</span>, chr, <span class="st">&quot;.map&quot;</span>)), <span class="dt">col.names =</span> F, </span>
<span id="cb5-13"><a href="#cb5-13"></a>        <span class="dt">row.names =</span> F, <span class="dt">quote =</span> F)</span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="kw">write.table</span>(<span class="kw">cbind</span>(FID, IID, PAT, MAT, SEX, PHENOTYPE, X[, map<span class="op">$</span>Chr <span class="op">==</span><span class="st"> </span>chr]), <span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_input_chr&quot;</span>, </span>
<span id="cb5-15"><a href="#cb5-15"></a>        chr, <span class="st">&quot;.raw&quot;</span>)), <span class="dt">col.names =</span> T, <span class="dt">row.names =</span> F, <span class="dt">quote =</span> F)</span>
<span id="cb5-16"><a href="#cb5-16"></a>}</span></code></pre></div>
</div>
</div>
<div id="part-ii-main-analysis" class="section level2">
<h2>Part II: Main analysis</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(nclust)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">registerDoParallel</span>(cl)</span></code></pre></div>
<div id="steps-1-5-calculation-of-pairwise-recombination-rates" class="section level3">
<h3>Steps 1-5: Calculation of pairwise recombination rates</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>out &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">chr =</span> <span class="dv">1</span><span class="op">:</span>nchr, <span class="dt">.packages =</span> <span class="st">&quot;hsrecombi&quot;</span>) <span class="op">%dopar%</span><span class="st"> </span>{</span>
<span id="cb7-2"><a href="#cb7-2"></a>    </span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="co"># 1: Physical map</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>    map &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;map_chr&quot;</span>, chr, <span class="st">&quot;.map&quot;</span>)), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Chr&quot;</span>, <span class="st">&quot;Name&quot;</span>, </span>
<span id="cb7-5"><a href="#cb7-5"></a>        <span class="st">&quot;locus_Mb&quot;</span>, <span class="st">&quot;locus_bp&quot;</span>))</span>
<span id="cb7-6"><a href="#cb7-6"></a>    map<span class="op">$</span>SNP &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(map)</span>
<span id="cb7-7"><a href="#cb7-7"></a>    locus_Mb &lt;-<span class="st"> </span>map<span class="op">$</span>locus_Mb</span>
<span id="cb7-8"><a href="#cb7-8"></a>    </span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="co"># 2: Genotype matrix</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>    genomatrix &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">fread</span>(<span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_input_chr&quot;</span>, chr, <span class="st">&quot;.raw&quot;</span>)))</span>
<span id="cb7-11"><a href="#cb7-11"></a>    X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(genomatrix[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)])</span>
<span id="cb7-12"><a href="#cb7-12"></a>    </span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="co"># 3: Assign daughters to sire IDs</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>    daughterSire &lt;-<span class="st"> </span>genomatrix<span class="op">$</span>PAT</span>
<span id="cb7-15"><a href="#cb7-15"></a>    </span>
<span id="cb7-16"><a href="#cb7-16"></a>    <span class="co"># 4: Estimate sire haplotypes and format data</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>    hap &lt;-<span class="st"> </span><span class="kw">makehappm</span>(<span class="kw">unique</span>(daughterSire), daughterSire, X)</span>
<span id="cb7-18"><a href="#cb7-18"></a>    <span class="kw">save</span>(<span class="st">&quot;hap&quot;</span>, <span class="dt">file =</span> <span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_output_chr&quot;</span>, chr, <span class="st">&quot;.Rdata&quot;</span>)))</span>
<span id="cb7-19"><a href="#cb7-19"></a>    </span>
<span id="cb7-20"><a href="#cb7-20"></a>    <span class="co"># Check order and dimension</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>    io &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(map), <span class="cf">function</span>(z) {</span>
<span id="cb7-22"><a href="#cb7-22"></a>        <span class="kw">grepl</span>(<span class="dt">x =</span> <span class="kw">colnames</span>(X)[z], <span class="dt">pattern =</span> map<span class="op">$</span>Name[z])</span>
<span id="cb7-23"><a href="#cb7-23"></a>    })</span>
<span id="cb7-24"><a href="#cb7-24"></a>    <span class="cf">if</span> (<span class="kw">sum</span>(io) <span class="op">!=</span><span class="st"> </span><span class="kw">nrow</span>(map)) </span>
<span id="cb7-25"><a href="#cb7-25"></a>        <span class="kw">stop</span>(<span class="st">&quot;ERROR in dimension&quot;</span>)</span>
<span id="cb7-26"><a href="#cb7-26"></a>    </span>
<span id="cb7-27"><a href="#cb7-27"></a>    <span class="co"># 5: Estimate recombination rates</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>    res &lt;-<span class="st"> </span><span class="kw">hsrecombi</span>(hap, X, map<span class="op">$</span>SNP)</span>
<span id="cb7-29"><a href="#cb7-29"></a>    final &lt;-<span class="st"> </span><span class="kw">editraw</span>(res, map)</span>
<span id="cb7-30"><a href="#cb7-30"></a>    <span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">c</span>(<span class="st">&quot;final&quot;</span>, <span class="st">&quot;locus_Mb&quot;</span>), <span class="dt">file =</span> <span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))</span>
<span id="cb7-31"><a href="#cb7-31"></a>    </span>
<span id="cb7-32"><a href="#cb7-32"></a>    <span class="kw">ifelse</span>(<span class="kw">nrow</span>(final) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;OK&quot;</span>, <span class="st">&quot;no result&quot;</span>)</span>
<span id="cb7-33"><a href="#cb7-33"></a>}</span>
<span id="cb7-34"><a href="#cb7-34"></a><span class="kw">print</span>(<span class="kw">which</span>(<span class="kw">unlist</span>(out) <span class="op">==</span><span class="st"> &quot;OK&quot;</span>))</span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="co">#&gt; [1] 1 2</span></span></code></pre></div>
<p>In step 4, function <code>makehap</code> would be sufficient but <code>makehappm</code> allows comparison with a deterministic approach shown later. Note that sire haplotypes can also be obtained by some other (external) software. Then sire haplotypes and sire-to-daughter information need to be reshaped with <code>makehaplist</code> in step 4.</p>
</div>
<div id="check-for-candidates-of-misplacement" class="section level3">
<h3>6: Check for candidates of misplacement</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># 6a: Filter SNPs with unusually large recombination rate to neighbouring (30) SNPs</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>excl &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">chr =</span> <span class="dv">1</span><span class="op">:</span>nchr, <span class="dt">.packages =</span> <span class="st">&quot;hsrecombi&quot;</span>) <span class="op">%dopar%</span><span class="st"> </span>{</span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))</span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="kw">checkCandidates</span>(final)</span>
<span id="cb8-5"><a href="#cb8-5"></a>}</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># 6b: Heatmap plot of recombination rates for visual verification, e.g.:</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>chr &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))</span>
<span id="cb8-10"><a href="#cb8-10"></a>cand &lt;-<span class="st"> </span>excl[[chr]][<span class="dv">1</span>]</span>
<span id="cb8-11"><a href="#cb8-11"></a>win &lt;-<span class="st"> </span>cand <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">100</span><span class="op">:</span><span class="dv">100</span>)</span>
<span id="cb8-12"><a href="#cb8-12"></a>win &lt;-<span class="st"> </span>win[(win <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(win <span class="op">&lt;=</span><span class="st"> </span><span class="kw">max</span>(final<span class="op">$</span>SNP2))]</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a>target &lt;-<span class="st"> </span>final[(final<span class="op">$</span>SNP1 <span class="op">%in%</span><span class="st"> </span>win) <span class="op">&amp;</span><span class="st"> </span>(final<span class="op">$</span>SNP2 <span class="op">%in%</span><span class="st"> </span>win), ]</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> target, <span class="kw">aes</span>(SNP2, SNP1, <span class="dt">fill =</span> theta)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Locus 2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Locus 1&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;reverse&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">size =</span> <span class="fl">0.1</span>), <span class="dt">panel.grid.minor =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">1e-10</span>), <span class="dt">na.value =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># -&gt; nothing conspicious</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>excl[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>excl[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="ot">NA</span></span></code></pre></div>
<p>Orange colour in the SNP neighbourhood implies an increased recombination rate. In case of a misplaced marker or a cluster of misplaced markers, the heatmap is characterised by an orange band.</p>
</div>
<div id="approximation-of-genetic-positions" class="section level3">
<h3>7: Approximation of genetic positions</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>pos &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">chr =</span> <span class="dv">1</span><span class="op">:</span>nchr, <span class="dt">.packages =</span> <span class="st">&quot;hsrecombi&quot;</span>) <span class="op">%dopar%</span><span class="st"> </span>{</span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))</span>
<span id="cb10-3"><a href="#cb10-3"></a>    out &lt;-<span class="st"> </span><span class="kw">geneticPosition</span>(final, <span class="dt">exclude =</span> excl[[chr]])</span>
<span id="cb10-4"><a href="#cb10-4"></a>    <span class="kw">list</span>(<span class="dt">pos.cM =</span> <span class="kw">c</span>(out, <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(locus_Mb) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(out))), <span class="dt">pos.Mb =</span> locus_Mb)</span>
<span id="cb10-5"><a href="#cb10-5"></a>}</span></code></pre></div>
<p>Genetic position is reported as NA if the corresponding SNP has not been considered in the analysis (e.g., when no sire was heterozygous at the corresponding SNP).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">stopCluster</span>(cl)</span></code></pre></div>
</div>
<div id="plot-of-physical-versus-genetic-map-positions" class="section level3">
<h3>8: Plot of physical versus genetic-map positions</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Chr =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(pos), <span class="dt">times =</span> <span class="kw">unlist</span>(<span class="kw">list.select</span>(pos, <span class="kw">length</span>(pos.Mb)))), <span class="dt">Mbp =</span> <span class="kw">unlist</span>(<span class="kw">list.select</span>(pos, </span>
<span id="cb12-2"><a href="#cb12-2"></a>    pos.Mb)), <span class="dt">cM =</span> <span class="kw">unlist</span>(<span class="kw">list.select</span>(pos, pos.cM)))</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Mbp, <span class="dt">y =</span> cM)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">na.rm =</span> T) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(Chr <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="part-iii-visual-comparison-with-simulated-data-and-deterministic-approach" class="section level2">
<h2>Part III: Visual comparison with simulated data and deterministic approach</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>chr &lt;-<span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<div id="check-with-simulated-data" class="section level3">
<h3>1: Check with simulated data</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">load</span>(<span class="kw">file.path</span>(path.dat, <span class="st">&quot;pop.RData&quot;</span>))</span>
<span id="cb14-2"><a href="#cb14-2"></a>sim.cM &lt;-<span class="st"> </span><span class="kw">cumsum</span>(probRec[[chr]]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<p>The position of a recombination event is traced in <code>SP$recHist</code> which has a nested list structure (individual, chromosome, female/male haplotype). The recombination rate between adjacent SNPs is determined as the proportion of recombinant progeny and the positions are derived as cumulative sum over recombination rates.</p>
</div>
<div id="check-with-deterministic-approach" class="section level3">
<h3>2: Check with deterministic approach</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_output_chr&quot;</span>, chr, <span class="st">&quot;.Rdata&quot;</span>)))</span>
<span id="cb15-2"><a href="#cb15-2"></a>hsphase.cM &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">cumsum</span>(hap<span class="op">$</span>probRec)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<p>The results are compared to the deterministic approach of <a href="https://doi.org/10.1186/1297-9686-46-11">Ferdosi et al.Â (2014)</a> provided in the R package <a href="https://CRAN.R-project.org/package=hsphase"><em>hsphase</em></a>. Functions of that package are called in <code>makehap</code> and <code>makehappm</code>.</p>
</div>
<div id="comparative-plot-of-physical-versus-genetic-map-positions" class="section level3">
<h3>3: Comparative plot of physical versus genetic-map positions</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">9.1</span>), <span class="dt">xpd =</span> <span class="ot">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">plot</span>(pos[[chr]]<span class="op">$</span>pos.Mb, pos[[chr]]<span class="op">$</span>pos.cM, <span class="dt">xlab =</span> <span class="st">&quot;physical position (Mbp)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;genetic position (cM)&quot;</span>, </span>
<span id="cb16-3"><a href="#cb16-3"></a>    <span class="dt">ylim =</span> <span class="kw">range</span>(<span class="kw">c</span>(sim.cM, hsphase.cM, pos[[chr]]<span class="op">$</span>pos.cM), <span class="dt">na.rm =</span> T), <span class="dt">pch =</span> <span class="dv">20</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw">points</span>(pos[[chr]]<span class="op">$</span>pos.Mb, sim.cM, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">4</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="kw">points</span>(pos[[chr]]<span class="op">$</span>pos.Mb, hsphase.cM, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">8</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="fl">1.01</span>, <span class="dv">0</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;simulated&quot;</span>, <span class="st">&quot;likelihood-based&quot;</span>, <span class="st">&quot;deterministic&quot;</span>), <span class="dt">pch =</span> <span class="dv">20</span>, </span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">8</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> The likelihood-based approach requires a sufficiently large sample size if SNP density is high. A verification of the bias of genetic-map positions can be found in the Supplemental Material of <a href="https://doi.org/10.1186/s12711-020-00593-z">Qanbari &amp; Wittenburg (2020, Genet Sel Evol)</a>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">unlink</span>(path.dat, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">unlink</span>(path.res, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw">Sys.time</span>()</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt; [1] &quot;2021-03-23 08:57:42 CET&quot;</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
